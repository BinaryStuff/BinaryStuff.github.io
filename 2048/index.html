<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8" />
    <title>2048</title>
    <link rel="stylesheet" href="style.css" />
    <script src="app.js" charset="utf-8"></script>
  </head>
  <body>
    <div class="container">
      <div class="info">
        <h1>2048</h1>
        <div class="score-container">
          <div class="score-title">score</div>
          <span id="score">0</span>
        </div>
      </div>
      <span id="result">Dev High Score is <b>3228</b> good luck!</span>
      <div class="grid"></div>
    </div>
    <script>
  let solverInterval;
  let isSolverRunning = false;

  // Move logic directly copied from your existing functions
  function moveRight() {
    for (let i = 0; i < 16; i++) {
      if (i % 4 === 0) {
        let totalOne = squares[i].innerHTML;
        let totalTwo = squares[i + 1].innerHTML;
        let totalThree = squares[i + 2].innerHTML;
        let totalFour = squares[i + 3].innerHTML;
        let row = [parseInt(totalOne), parseInt(totalTwo), parseInt(totalThree), parseInt(totalFour)];

        let filteredRow = row.filter(num => num);
        let missing = 4 - filteredRow.length;
        let zeros = Array(missing).fill(0);
        let newRow = zeros.concat(filteredRow);

        squares[i].innerHTML = newRow[0];
        squares[i + 1].innerHTML = newRow[1];
        squares[i + 2].innerHTML = newRow[2];
        squares[i + 3].innerHTML = newRow[3];
      }
    }
  }

  function moveLeft() {
    for (let i = 0; i < 16; i++) {
      if (i % 4 === 0) {
        let totalOne = squares[i].innerHTML;
        let totalTwo = squares[i + 1].innerHTML;
        let totalThree = squares[i + 2].innerHTML;
        let totalFour = squares[i + 3].innerHTML;
        let row = [parseInt(totalOne), parseInt(totalTwo), parseInt(totalThree), parseInt(totalFour)];

        let filteredRow = row.filter(num => num);
        let missing = 4 - filteredRow.length;
        let zeros = Array(missing).fill(0);
        let newRow = filteredRow.concat(zeros);

        squares[i].innerHTML = newRow[0];
        squares[i + 1].innerHTML = newRow[1];
        squares[i + 2].innerHTML = newRow[2];
        squares[i + 3].innerHTML = newRow[3];
      }
    }
  }

  function moveUp() {
    for (let i = 0; i < 4; i++) {
      let totalOne = squares[i].innerHTML;
      let totalTwo = squares[i + width].innerHTML;
      let totalThree = squares[i + (width * 2)].innerHTML;
      let totalFour = squares[i + (width * 3)].innerHTML;
      let column = [parseInt(totalOne), parseInt(totalTwo), parseInt(totalThree), parseInt(totalFour)];

      let filteredColumn = column.filter(num => num);
      let missing = 4 - filteredColumn.length;
      let zeros = Array(missing).fill(0);
      let newColumn = filteredColumn.concat(zeros);

      squares[i].innerHTML = newColumn[0];
      squares[i + width].innerHTML = newColumn[1];
      squares[i + (width * 2)].innerHTML = newColumn[2];
      squares[i + (width * 3)].innerHTML = newColumn[3];
    }
  }

  function moveDown() {
    for (let i = 0; i < 4; i++) {
      let totalOne = squares[i].innerHTML;
      let totalTwo = squares[i + width].innerHTML;
      let totalThree = squares[i + (width * 2)].innerHTML;
      let totalFour = squares[i + (width * 3)].innerHTML;
      let column = [parseInt(totalOne), parseInt(totalTwo), parseInt(totalThree), parseInt(totalFour)];

      let filteredColumn = column.filter(num => num);
      let missing = 4 - filteredColumn.length;
      let zeros = Array(missing).fill(0);
      let newColumn = zeros.concat(filteredColumn);

      squares[i].innerHTML = newColumn[0];
      squares[i + width].innerHTML = newColumn[1];
      squares[i + (width * 2)].innerHTML = newColumn[2];
      squares[i + (width * 3)].innerHTML = newColumn[3];
    }
  }

  // AI Move Logic
  function aiMove() {
    const moves = ['moveRight', 'moveLeft', 'moveUp', 'moveDown'];
    const randomMove = moves[Math.floor(Math.random() * moves.length)];

    if (randomMove === 'moveRight') moveRight();
    else if (randomMove === 'moveLeft') moveLeft();
    else if (randomMove === 'moveUp') moveUp();
    else if (randomMove === 'moveDown') moveDown();

    generate();  // Generate a new number after move
  }

  // Toggle solver when "L" is pressed
  function toggleSolver(e) {
    if (e.key === 'L' || e.key === 'l') {
      if (isSolverRunning) {
        clearInterval(solverInterval);  // Stop the solver
        isSolverRunning = false;
      } else {
        solverInterval = setInterval(aiMove, 200);  // Run AI every 200ms
        isSolverRunning = true;
      }
    }
  }

  // Listen for key presses
  document.addEventListener('keydown', toggleSolver);
</script>



  </body>
  <!--The JS-->
  <script
    src="https://kit.fontawesome.com/7b89acb6a8.js"
    crossorigin="anonymous"
  ></script>

  <!--The CSS-->
  <p>
    <a href="../index.html"
      ><span
        style="
          font-size: 4em;
          color: #f00000;
          padding: 10px;
          position: absolute;
          right: 20px;
          bottom: 20px;
        "
      >
        <i class="fa-solid fa-house"></i> </span
    ></a>
  </p>
</html>
